"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/pipeline";
exports.ids = ["pages/api/pipeline"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fpipeline&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fpipeline.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fpipeline&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fpipeline.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_pipeline_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/pipeline.js */ \"(api)/./src/pages/api/pipeline.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_pipeline_js__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_pipeline_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_pipeline_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_pipeline_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/pipeline\",\n        pathname: \"/api/pipeline\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_pipeline_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnBpcGVsaW5lJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTJGcGFnZXMlMkZhcGklMkZwaXBlbGluZS5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN3RDtBQUN4RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rocml2ZW4td2ViLz80MTNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmMvcGFnZXMvYXBpL3BpcGVsaW5lLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcGlwZWxpbmVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9waXBlbGluZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fpipeline&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fpipeline.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/lib/cli.js":
/*!************************!*\
  !*** ./src/lib/cli.js ***!
  \************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   analyze: () => (/* binding */ analyze),\n/* harmony export */   applyStemmap: () => (/* binding */ applyStemmap),\n/* harmony export */   exportFiles: () => (/* binding */ exportFiles),\n/* harmony export */   prepBR864: () => (/* binding */ prepBR864),\n/* harmony export */   process: () => (/* binding */ process),\n/* harmony export */   runCommand: () => (/* binding */ runCommand),\n/* harmony export */   scan: () => (/* binding */ scan),\n/* harmony export */   stemmap: () => (/* binding */ stemmap)\n/* harmony export */ });\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! url */ \"url\");\n\n\n\n// Get the directory of the current module\nconst __filename = (0,url__WEBPACK_IMPORTED_MODULE_2__.fileURLToPath)(\"file:///app/web/src/lib/cli.js\");\nconst __dirname = path__WEBPACK_IMPORTED_MODULE_1__.dirname(__filename);\n// CLI path relative to the web directory\nconst CLI_PATH = path__WEBPACK_IMPORTED_MODULE_1__.join(__dirname, \"..\", \"..\", \"..\", \"bin\", \"thriven\");\n/**\n * Execute a CLI command and return the result\n */ function runCommand(command, args = [], options = {}) {\n    return new Promise((resolve, reject)=>{\n        const nodeArgs = [\n            CLI_PATH,\n            command,\n            ...args\n        ];\n        const proc = (0,child_process__WEBPACK_IMPORTED_MODULE_0__.spawn)(\"node\", nodeArgs, {\n            cwd: options.cwd || process.cwd(),\n            env: {\n                ...process.env,\n                ...options.env\n            }\n        });\n        let stdout = \"\";\n        let stderr = \"\";\n        let progress = 0;\n        proc.stdout.on(\"data\", (data)=>{\n            const text = data.toString();\n            stdout += text;\n            // Parse progress from output if available\n            const progressMatch = text.match(/(\\d+)%/);\n            if (progressMatch) {\n                progress = parseInt(progressMatch[1], 10);\n                if (options.onProgress) {\n                    options.onProgress(progress);\n                }\n            }\n        });\n        proc.stderr.on(\"data\", (data)=>{\n            stderr += data.toString();\n        });\n        proc.on(\"error\", (error)=>{\n            reject(new Error(`Failed to start command: ${error.message}`));\n        });\n        proc.on(\"close\", (code)=>{\n            if (code === 0) {\n                resolve({\n                    stdout,\n                    stderr,\n                    code\n                });\n            } else {\n                reject(new Error(`Command exited with code ${code}: ${stderr || stdout}`));\n            }\n        });\n    });\n}\n/**\n * Scan a folder for audio files\n */ async function scan(folder, options = {}) {\n    const args = [\n        folder\n    ];\n    if (options.output) args.push(\"-o\", options.output);\n    if (options.formats) args.push(\"--formats\", options.formats);\n    if (options.recursive !== false) args.push(\"-r\");\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"scan\", args, options);\n}\n/**\n * Analyze audio files from raw_index.json\n */ async function analyze(indexPath, options = {}) {\n    const args = [\n        indexPath\n    ];\n    if (options.output) args.push(\"-o\", options.output);\n    if (options.parallel) args.push(\"-p\", String(options.parallel));\n    if (options.noLoudness) args.push(\"--no-loudness\");\n    if (options.noSilence) args.push(\"--no-silence\");\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"analyze\", args, options);\n}\n/**\n * Export top N ranked files\n */ async function exportFiles(analysisPath, options = {}) {\n    const args = [\n        analysisPath\n    ];\n    if (options.top) args.push(\"-t\", String(options.top));\n    if (options.output) args.push(\"-o\", options.output);\n    if (options.saveRanked) args.push(\"--save-ranked\", options.saveRanked);\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"export\", args, options);\n}\n/**\n * Generate stemmap.yaml template\n */ async function stemmap(packDir, options = {}) {\n    const args = [\n        packDir\n    ];\n    if (options.inDir) args.push(\"--in\", options.inDir);\n    if (options.outPath) args.push(\"--out\", options.outPath);\n    if (options.bpmMin) args.push(\"--bpm-min\", String(options.bpmMin));\n    if (options.bpmMax) args.push(\"--bpm-max\", String(options.bpmMax));\n    if (options.title) args.push(\"--title\", options.title);\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"stemmap\", args, options);\n}\n/**\n * Apply stemmap.yaml to create stems_8/\n */ async function applyStemmap(packDir, options = {}) {\n    const args = [\n        packDir\n    ];\n    if (options.map) args.push(\"--map\", options.map);\n    if (options.inDir) args.push(\"--in\", options.inDir);\n    if (options.outDir) args.push(\"--out\", options.outDir);\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"apply-stemmap\", args, options);\n}\n/**\n * Prepare stems for BR-864\n */ async function prepBR864(packDir, options = {}) {\n    const args = [\n        packDir\n    ];\n    if (options.inDir) args.push(\"--in\", options.inDir);\n    if (options.outDir) args.push(\"--out\", options.outDir);\n    if (options.padToLongest) args.push(\"--pad-to-longest\");\n    if (options.trimToShortest) args.push(\"--trim-to-shortest\");\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"prep-br864\", args, options);\n}\n/**\n * Run the full process pipeline\n */ async function process(folder, options = {}) {\n    const args = [\n        folder\n    ];\n    if (options.top) args.push(\"-t\", String(options.top));\n    if (options.output) args.push(\"-o\", options.output);\n    if (options.verbose) args.push(\"-v\");\n    return runCommand(\"process\", args, options);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSTNCLFFBQVE4QixPQUFPLEVBQUUvQixLQUFLNEIsSUFBSSxDQUFDO0lBRS9CLE9BQU85QixXQUFXLGNBQWNFLE1BQU1DO0FBQ3hDO0FBRUE7O0NBRUMsR0FDTSxlQUFlTyxRQUFRa0IsTUFBTSxFQUFFekIsVUFBVSxDQUFDLENBQUM7SUFDaEQsTUFBTUQsT0FBTztRQUFDMEI7S0FBTztJQUNyQixJQUFJekIsUUFBUXVDLEdBQUcsRUFBRXhDLEtBQUs0QixJQUFJLENBQUMsTUFBTU8sT0FBT2xDLFFBQVF1QyxHQUFHO0lBQ25ELElBQUl2QyxRQUFRMEIsTUFBTSxFQUFFM0IsS0FBSzRCLElBQUksQ0FBQyxNQUFNM0IsUUFBUTBCLE1BQU07SUFDbEQsSUFBSTFCLFFBQVE4QixPQUFPLEVBQUUvQixLQUFLNEIsSUFBSSxDQUFDO0lBRS9CLE9BQU85QixXQUFXLFdBQVdFLE1BQU1DO0FBQ3JDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhyaXZlbi13ZWIvLi9zcmMvbGliL2NsaS5qcz9kNDkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNwYXduIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGZpbGVVUkxUb1BhdGggfSBmcm9tICd1cmwnO1xuXG4vLyBHZXQgdGhlIGRpcmVjdG9yeSBvZiB0aGUgY3VycmVudCBtb2R1bGVcbmNvbnN0IF9fZmlsZW5hbWUgPSBmaWxlVVJMVG9QYXRoKGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBfX2Rpcm5hbWUgPSBwYXRoLmRpcm5hbWUoX19maWxlbmFtZSk7XG5cbi8vIENMSSBwYXRoIHJlbGF0aXZlIHRvIHRoZSB3ZWIgZGlyZWN0b3J5XG5jb25zdCBDTElfUEFUSCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICcuLicsICcuLicsICdiaW4nLCAndGhyaXZlbicpO1xuXG4vKipcbiAqIEV4ZWN1dGUgYSBDTEkgY29tbWFuZCBhbmQgcmV0dXJuIHRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJ1bkNvbW1hbmQoY29tbWFuZCwgYXJncyA9IFtdLCBvcHRpb25zID0ge30pIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBub2RlQXJncyA9IFtDTElfUEFUSCwgY29tbWFuZCwgLi4uYXJnc107XG4gICAgY29uc3QgcHJvYyA9IHNwYXduKCdub2RlJywgbm9kZUFyZ3MsIHtcbiAgICAgIGN3ZDogb3B0aW9ucy5jd2QgfHwgcHJvY2Vzcy5jd2QoKSxcbiAgICAgIGVudjogeyAuLi5wcm9jZXNzLmVudiwgLi4ub3B0aW9ucy5lbnYgfSxcbiAgICB9KTtcblxuICAgIGxldCBzdGRvdXQgPSAnJztcbiAgICBsZXQgc3RkZXJyID0gJyc7XG4gICAgbGV0IHByb2dyZXNzID0gMDtcblxuICAgIHByb2Muc3Rkb3V0Lm9uKCdkYXRhJywgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHRleHQgPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICBzdGRvdXQgKz0gdGV4dDtcbiAgICAgIC8vIFBhcnNlIHByb2dyZXNzIGZyb20gb3V0cHV0IGlmIGF2YWlsYWJsZVxuICAgICAgY29uc3QgcHJvZ3Jlc3NNYXRjaCA9IHRleHQubWF0Y2goLyhcXGQrKSUvKTtcbiAgICAgIGlmIChwcm9ncmVzc01hdGNoKSB7XG4gICAgICAgIHByb2dyZXNzID0gcGFyc2VJbnQocHJvZ3Jlc3NNYXRjaFsxXSwgMTApO1xuICAgICAgICBpZiAob3B0aW9ucy5vblByb2dyZXNzKSB7XG4gICAgICAgICAgb3B0aW9ucy5vblByb2dyZXNzKHByb2dyZXNzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcHJvYy5zdGRlcnIub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgc3RkZXJyICs9IGRhdGEudG9TdHJpbmcoKTtcbiAgICB9KTtcblxuICAgIHByb2Mub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7XG4gICAgICByZWplY3QobmV3IEVycm9yKGBGYWlsZWQgdG8gc3RhcnQgY29tbWFuZDogJHtlcnJvci5tZXNzYWdlfWApKTtcbiAgICB9KTtcblxuICAgIHByb2Mub24oJ2Nsb3NlJywgKGNvZGUpID0+IHtcbiAgICAgIGlmIChjb2RlID09PSAwKSB7XG4gICAgICAgIHJlc29sdmUoeyBzdGRvdXQsIHN0ZGVyciwgY29kZSB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlamVjdChuZXcgRXJyb3IoYENvbW1hbmQgZXhpdGVkIHdpdGggY29kZSAke2NvZGV9OiAke3N0ZGVyciB8fCBzdGRvdXR9YCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuLyoqXG4gKiBTY2FuIGEgZm9sZGVyIGZvciBhdWRpbyBmaWxlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2Nhbihmb2xkZXIsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCBhcmdzID0gW2ZvbGRlcl07XG4gIGlmIChvcHRpb25zLm91dHB1dCkgYXJncy5wdXNoKCctbycsIG9wdGlvbnMub3V0cHV0KTtcbiAgaWYgKG9wdGlvbnMuZm9ybWF0cykgYXJncy5wdXNoKCctLWZvcm1hdHMnLCBvcHRpb25zLmZvcm1hdHMpO1xuICBpZiAob3B0aW9ucy5yZWN1cnNpdmUgIT09IGZhbHNlKSBhcmdzLnB1c2goJy1yJyk7XG4gIGlmIChvcHRpb25zLnZlcmJvc2UpIGFyZ3MucHVzaCgnLXYnKTtcbiAgXG4gIHJldHVybiBydW5Db21tYW5kKCdzY2FuJywgYXJncywgb3B0aW9ucyk7XG59XG5cbi8qKlxuICogQW5hbHl6ZSBhdWRpbyBmaWxlcyBmcm9tIHJhd19pbmRleC5qc29uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhbmFseXplKGluZGV4UGF0aCwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IGFyZ3MgPSBbaW5kZXhQYXRoXTtcbiAgaWYgKG9wdGlvbnMub3V0cHV0KSBhcmdzLnB1c2goJy1vJywgb3B0aW9ucy5vdXRwdXQpO1xuICBpZiAob3B0aW9ucy5wYXJhbGxlbCkgYXJncy5wdXNoKCctcCcsIFN0cmluZyhvcHRpb25zLnBhcmFsbGVsKSk7XG4gIGlmIChvcHRpb25zLm5vTG91ZG5lc3MpIGFyZ3MucHVzaCgnLS1uby1sb3VkbmVzcycpO1xuICBpZiAob3B0aW9ucy5ub1NpbGVuY2UpIGFyZ3MucHVzaCgnLS1uby1zaWxlbmNlJyk7XG4gIGlmIChvcHRpb25zLnZlcmJvc2UpIGFyZ3MucHVzaCgnLXYnKTtcbiAgXG4gIHJldHVybiBydW5Db21tYW5kKCdhbmFseXplJywgYXJncywgb3B0aW9ucyk7XG59XG5cbi8qKlxuICogRXhwb3J0IHRvcCBOIHJhbmtlZCBmaWxlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhwb3J0RmlsZXMoYW5hbHlzaXNQYXRoLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgYXJncyA9IFthbmFseXNpc1BhdGhdO1xuICBpZiAob3B0aW9ucy50b3ApIGFyZ3MucHVzaCgnLXQnLCBTdHJpbmcob3B0aW9ucy50b3ApKTtcbiAgaWYgKG9wdGlvbnMub3V0cHV0KSBhcmdzLnB1c2goJy1vJywgb3B0aW9ucy5vdXRwdXQpO1xuICBpZiAob3B0aW9ucy5zYXZlUmFua2VkKSBhcmdzLnB1c2goJy0tc2F2ZS1yYW5rZWQnLCBvcHRpb25zLnNhdmVSYW5rZWQpO1xuICBpZiAob3B0aW9ucy52ZXJib3NlKSBhcmdzLnB1c2goJy12Jyk7XG4gIFxuICByZXR1cm4gcnVuQ29tbWFuZCgnZXhwb3J0JywgYXJncywgb3B0aW9ucyk7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgc3RlbW1hcC55YW1sIHRlbXBsYXRlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGVtbWFwKHBhY2tEaXIsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCBhcmdzID0gW3BhY2tEaXJdO1xuICBpZiAob3B0aW9ucy5pbkRpcikgYXJncy5wdXNoKCctLWluJywgb3B0aW9ucy5pbkRpcik7XG4gIGlmIChvcHRpb25zLm91dFBhdGgpIGFyZ3MucHVzaCgnLS1vdXQnLCBvcHRpb25zLm91dFBhdGgpO1xuICBpZiAob3B0aW9ucy5icG1NaW4pIGFyZ3MucHVzaCgnLS1icG0tbWluJywgU3RyaW5nKG9wdGlvbnMuYnBtTWluKSk7XG4gIGlmIChvcHRpb25zLmJwbU1heCkgYXJncy5wdXNoKCctLWJwbS1tYXgnLCBTdHJpbmcob3B0aW9ucy5icG1NYXgpKTtcbiAgaWYgKG9wdGlvbnMudGl0bGUpIGFyZ3MucHVzaCgnLS10aXRsZScsIG9wdGlvbnMudGl0bGUpO1xuICBpZiAob3B0aW9ucy52ZXJib3NlKSBhcmdzLnB1c2goJy12Jyk7XG4gIFxuICByZXR1cm4gcnVuQ29tbWFuZCgnc3RlbW1hcCcsIGFyZ3MsIG9wdGlvbnMpO1xufVxuXG4vKipcbiAqIEFwcGx5IHN0ZW1tYXAueWFtbCB0byBjcmVhdGUgc3RlbXNfOC9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGx5U3RlbW1hcChwYWNrRGlyLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgYXJncyA9IFtwYWNrRGlyXTtcbiAgaWYgKG9wdGlvbnMubWFwKSBhcmdzLnB1c2goJy0tbWFwJywgb3B0aW9ucy5tYXApO1xuICBpZiAob3B0aW9ucy5pbkRpcikgYXJncy5wdXNoKCctLWluJywgb3B0aW9ucy5pbkRpcik7XG4gIGlmIChvcHRpb25zLm91dERpcikgYXJncy5wdXNoKCctLW91dCcsIG9wdGlvbnMub3V0RGlyKTtcbiAgaWYgKG9wdGlvbnMudmVyYm9zZSkgYXJncy5wdXNoKCctdicpO1xuICBcbiAgcmV0dXJuIHJ1bkNvbW1hbmQoJ2FwcGx5LXN0ZW1tYXAnLCBhcmdzLCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBQcmVwYXJlIHN0ZW1zIGZvciBCUi04NjRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByZXBCUjg2NChwYWNrRGlyLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgYXJncyA9IFtwYWNrRGlyXTtcbiAgaWYgKG9wdGlvbnMuaW5EaXIpIGFyZ3MucHVzaCgnLS1pbicsIG9wdGlvbnMuaW5EaXIpO1xuICBpZiAob3B0aW9ucy5vdXREaXIpIGFyZ3MucHVzaCgnLS1vdXQnLCBvcHRpb25zLm91dERpcik7XG4gIGlmIChvcHRpb25zLnBhZFRvTG9uZ2VzdCkgYXJncy5wdXNoKCctLXBhZC10by1sb25nZXN0Jyk7XG4gIGlmIChvcHRpb25zLnRyaW1Ub1Nob3J0ZXN0KSBhcmdzLnB1c2goJy0tdHJpbS10by1zaG9ydGVzdCcpO1xuICBpZiAob3B0aW9ucy52ZXJib3NlKSBhcmdzLnB1c2goJy12Jyk7XG4gIFxuICByZXR1cm4gcnVuQ29tbWFuZCgncHJlcC1icjg2NCcsIGFyZ3MsIG9wdGlvbnMpO1xufVxuXG4vKipcbiAqIFJ1biB0aGUgZnVsbCBwcm9jZXNzIHBpcGVsaW5lXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzKGZvbGRlciwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IGFyZ3MgPSBbZm9sZGVyXTtcbiAgaWYgKG9wdGlvbnMudG9wKSBhcmdzLnB1c2goJy10JywgU3RyaW5nKG9wdGlvbnMudG9wKSk7XG4gIGlmIChvcHRpb25zLm91dHB1dCkgYXJncy5wdXNoKCctbycsIG9wdGlvbnMub3V0cHV0KTtcbiAgaWYgKG9wdGlvbnMudmVyYm9zZSkgYXJncy5wdXNoKCctdicpO1xuICBcbiAgcmV0dXJuIHJ1bkNvbW1hbmQoJ3Byb2Nlc3MnLCBhcmdzLCBvcHRpb25zKTtcbn1cbiJdLCJuYW1lcyI6WyJzcGF3biIsInBhdGgiLCJmaWxlVVJMVG9QYXRoIiwiX19maWxlbmFtZSIsInVybCIsIl9fZGlybmFtZSIsImRpcm5hbWUiLCJDTElfUEFUSCIsImpvaW4iLCJydW5Db21tYW5kIiwiY29tbWFuZCIsImFyZ3MiLCJvcHRpb25zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJub2RlQXJncyIsInByb2MiLCJjd2QiLCJwcm9jZXNzIiwiZW52Iiwic3Rkb3V0Iiwic3RkZXJyIiwicHJvZ3Jlc3MiLCJvbiIsImRhdGEiLCJ0ZXh0IiwidG9TdHJpbmciLCJwcm9ncmVzc01hdGNoIiwibWF0Y2giLCJwYXJzZUludCIsIm9uUHJvZ3Jlc3MiLCJlcnJvciIsIkVycm9yIiwibWVzc2FnZSIsImNvZGUiLCJzY2FuIiwiZm9sZGVyIiwib3V0cHV0IiwicHVzaCIsImZvcm1hdHMiLCJyZWN1cnNpdmUiLCJ2ZXJib3NlIiwiYW5hbHl6ZSIsImluZGV4UGF0aCIsInBhcmFsbGVsIiwiU3RyaW5nIiwibm9Mb3VkbmVzcyIsIm5vU2lsZW5jZSIsImV4cG9ydEZpbGVzIiwiYW5hbHlzaXNQYXRoIiwidG9wIiwic2F2ZVJhbmtlZCIsInN0ZW1tYXAiLCJwYWNrRGlyIiwiaW5EaXIiLCJvdXRQYXRoIiwiYnBtTWluIiwiYnBtTWF4IiwidGl0bGUiLCJhcHBseVN0ZW1tYXAiLCJtYXAiLCJvdXREaXIiLCJwcmVwQlI4NjQiLCJwYWRUb0xvbmdlc3QiLCJ0cmltVG9TaG9ydGVzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/cli.js\n");

/***/ }),

/***/ "(api)/./src/lib/db.js":
/*!***********************!*\
  !*** ./src/lib/db.js ***!
  \***********************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUpload: () => (/* binding */ createUpload),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getAllUploads: () => (/* binding */ getAllUploads),\n/* harmony export */   getAnalysisResult: () => (/* binding */ getAnalysisResult),\n/* harmony export */   getExports: () => (/* binding */ getExports),\n/* harmony export */   getStemmap: () => (/* binding */ getStemmap),\n/* harmony export */   getUpload: () => (/* binding */ getUpload),\n/* harmony export */   saveAnalysisResult: () => (/* binding */ saveAnalysisResult),\n/* harmony export */   saveExport: () => (/* binding */ saveExport),\n/* harmony export */   saveStemmap: () => (/* binding */ saveStemmap),\n/* harmony export */   updateUploadStatus: () => (/* binding */ updateUploadStatus)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n\nconst MONGO_URL = process.env.MONGO_URL || \"mongodb://localhost:27017\";\nconst DB_NAME = process.env.DB_NAME || \"thriven\";\nlet client = null;\nlet db = null;\nasync function getDb() {\n    if (db) return db;\n    client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(MONGO_URL);\n    await client.connect();\n    db = client.db(DB_NAME);\n    // Create indexes for better performance\n    await db.collection(\"uploads\").createIndex({\n        created_at: -1\n    });\n    await db.collection(\"analysis_results\").createIndex({\n        upload_id: 1\n    });\n    await db.collection(\"stemmaps\").createIndex({\n        upload_id: 1\n    });\n    await db.collection(\"exports\").createIndex({\n        upload_id: 1,\n        created_at: -1\n    });\n    return db;\n}\nasync function createUpload(data) {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    const doc = {\n        _id: data.id,\n        folder_path: data.folder_path,\n        folder_name: data.folder_name,\n        file_count: data.file_count || 0,\n        total_size_bytes: data.total_size_bytes || 0,\n        status: data.status || \"pending\",\n        created_at: new Date()\n    };\n    await collection.insertOne(doc);\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getUpload(id) {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    const doc = await collection.findOne({\n        _id: id\n    });\n    if (doc) {\n        return {\n            ...doc,\n            id: doc._id\n        };\n    }\n    return null;\n}\nasync function getAllUploads() {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    const docs = await collection.find({}).sort({\n        created_at: -1\n    }).toArray();\n    return docs.map((doc)=>({\n            ...doc,\n            id: doc._id\n        }));\n}\nasync function updateUploadStatus(id, status) {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    await collection.updateOne({\n        _id: id\n    }, {\n        $set: {\n            status\n        }\n    });\n}\nasync function saveAnalysisResult(data) {\n    const database = await getDb();\n    const collection = database.collection(\"analysis_results\");\n    const doc = {\n        _id: data.id,\n        upload_id: data.upload_id,\n        raw_index_json: data.raw_index_json,\n        analysis_index_json: data.analysis_index_json,\n        duplicates_json: data.duplicates_json,\n        created_at: new Date()\n    };\n    await collection.replaceOne({\n        upload_id: data.upload_id\n    }, doc, {\n        upsert: true\n    });\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getAnalysisResult(uploadId) {\n    const database = await getDb();\n    const collection = database.collection(\"analysis_results\");\n    const doc = await collection.findOne({\n        upload_id: uploadId\n    });\n    if (doc) {\n        return {\n            ...doc,\n            id: doc._id\n        };\n    }\n    return null;\n}\nasync function saveStemmap(data) {\n    const database = await getDb();\n    const collection = database.collection(\"stemmaps\");\n    const doc = {\n        _id: data.id,\n        upload_id: data.upload_id,\n        stemmap_yaml: data.stemmap_yaml,\n        pack_title: data.pack_title,\n        bpm: data.bpm,\n        key_signature: data.key_signature,\n        created_at: new Date()\n    };\n    await collection.replaceOne({\n        upload_id: data.upload_id\n    }, doc, {\n        upsert: true\n    });\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getStemmap(uploadId) {\n    const database = await getDb();\n    const collection = database.collection(\"stemmaps\");\n    const doc = await collection.findOne({\n        upload_id: uploadId\n    });\n    if (doc) {\n        return {\n            ...doc,\n            id: doc._id\n        };\n    }\n    return null;\n}\nasync function saveExport(data) {\n    const database = await getDb();\n    const collection = database.collection(\"exports\");\n    const doc = {\n        _id: data.id,\n        upload_id: data.upload_id,\n        export_type: data.export_type,\n        output_path: data.output_path,\n        manifest_json: data.manifest_json,\n        created_at: new Date()\n    };\n    await collection.insertOne(doc);\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getExports(uploadId) {\n    const database = await getDb();\n    const collection = database.collection(\"exports\");\n    const docs = await collection.find({\n        upload_id: uploadId\n    }).sort({\n        created_at: -1\n    }).toArray();\n    return docs.map((doc)=>({\n            ...doc,\n            id: doc._id\n        }));\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    getDb\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cyI6WyJ3ZWJwYWNrOi8vdGhyaXZlbi13ZWIvLi9zcmMvbGliL2RiLmpzPzdmOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9uZ29DbGllbnQgfSBmcm9tICdtb25nb2RiJztcblxuY29uc3QgTU9OR09fVVJMID0gcHJvY2Vzcy5lbnYuTU9OR09fVVJMIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3JztcbmNvbnN0IERCX05BTUUgPSBwcm9jZXNzLmVudi5EQl9OQU1FIHx8ICd0aHJpdmVuJztcblxubGV0IGNsaWVudCA9IG51bGw7XG5sZXQgZGIgPSBudWxsO1xuXG5hc3luYyBmdW5jdGlvbiBnZXREYigpIHtcbiAgaWYgKGRiKSByZXR1cm4gZGI7XG4gIFxuICBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQoTU9OR09fVVJMKTtcbiAgYXdhaXQgY2xpZW50LmNvbm5lY3QoKTtcbiAgZGIgPSBjbGllbnQuZGIoREJfTkFNRSk7XG4gIFxuICAvLyBDcmVhdGUgaW5kZXhlcyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VwbG9hZHMnKS5jcmVhdGVJbmRleCh7IGNyZWF0ZWRfYXQ6IC0xIH0pO1xuICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdhbmFseXNpc19yZXN1bHRzJykuY3JlYXRlSW5kZXgoeyB1cGxvYWRfaWQ6IDEgfSk7XG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3N0ZW1tYXBzJykuY3JlYXRlSW5kZXgoeyB1cGxvYWRfaWQ6IDEgfSk7XG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ2V4cG9ydHMnKS5jcmVhdGVJbmRleCh7IHVwbG9hZF9pZDogMSwgY3JlYXRlZF9hdDogLTEgfSk7XG4gIFxuICByZXR1cm4gZGI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVcGxvYWQoZGF0YSkge1xuICBjb25zdCBkYXRhYmFzZSA9IGF3YWl0IGdldERiKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCd1cGxvYWRzJyk7XG4gIFxuICBjb25zdCBkb2MgPSB7XG4gICAgX2lkOiBkYXRhLmlkLFxuICAgIGZvbGRlcl9wYXRoOiBkYXRhLmZvbGRlcl9wYXRoLFxuICAgIGZvbGRlcl9uYW1lOiBkYXRhLmZvbGRlcl9uYW1lLFxuICAgIGZpbGVfY291bnQ6IGRhdGEuZmlsZV9jb3VudCB8fCAwLFxuICAgIHRvdGFsX3NpemVfYnl0ZXM6IGRhdGEudG90YWxfc2l6ZV9ieXRlcyB8fCAwLFxuICAgIHN0YXR1czogZGF0YS5zdGF0dXMgfHwgJ3BlbmRpbmcnLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gIH07XG4gIFxuICBhd2FpdCBjb2xsZWN0aW9uLmluc2VydE9uZShkb2MpO1xuICByZXR1cm4geyAuLi5kb2MsIGlkOiBkb2MuX2lkIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVcGxvYWQoaWQpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbigndXBsb2FkcycpO1xuICBjb25zdCBkb2MgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyBfaWQ6IGlkIH0pO1xuICBpZiAoZG9jKSB7XG4gICAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsVXBsb2FkcygpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbigndXBsb2FkcycpO1xuICBjb25zdCBkb2NzID0gYXdhaXQgY29sbGVjdGlvbi5maW5kKHt9KS5zb3J0KHsgY3JlYXRlZF9hdDogLTEgfSkudG9BcnJheSgpO1xuICByZXR1cm4gZG9jcy5tYXAoZG9jID0+ICh7IC4uLmRvYywgaWQ6IGRvYy5faWQgfSkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXBsb2FkU3RhdHVzKGlkLCBzdGF0dXMpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbigndXBsb2FkcycpO1xuICBhd2FpdCBjb2xsZWN0aW9uLnVwZGF0ZU9uZSh7IF9pZDogaWQgfSwgeyAkc2V0OiB7IHN0YXR1cyB9IH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUFuYWx5c2lzUmVzdWx0KGRhdGEpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbignYW5hbHlzaXNfcmVzdWx0cycpO1xuICBcbiAgY29uc3QgZG9jID0ge1xuICAgIF9pZDogZGF0YS5pZCxcbiAgICB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkLFxuICAgIHJhd19pbmRleF9qc29uOiBkYXRhLnJhd19pbmRleF9qc29uLFxuICAgIGFuYWx5c2lzX2luZGV4X2pzb246IGRhdGEuYW5hbHlzaXNfaW5kZXhfanNvbixcbiAgICBkdXBsaWNhdGVzX2pzb246IGRhdGEuZHVwbGljYXRlc19qc29uLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gIH07XG4gIFxuICBhd2FpdCBjb2xsZWN0aW9uLnJlcGxhY2VPbmUoXG4gICAgeyB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkIH0sXG4gICAgZG9jLFxuICAgIHsgdXBzZXJ0OiB0cnVlIH1cbiAgKTtcbiAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QW5hbHlzaXNSZXN1bHQodXBsb2FkSWQpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbignYW5hbHlzaXNfcmVzdWx0cycpO1xuICBjb25zdCBkb2MgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyB1cGxvYWRfaWQ6IHVwbG9hZElkIH0pO1xuICBpZiAoZG9jKSB7XG4gICAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZVN0ZW1tYXAoZGF0YSkge1xuICBjb25zdCBkYXRhYmFzZSA9IGF3YWl0IGdldERiKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCdzdGVtbWFwcycpO1xuICBcbiAgY29uc3QgZG9jID0ge1xuICAgIF9pZDogZGF0YS5pZCxcbiAgICB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkLFxuICAgIHN0ZW1tYXBfeWFtbDogZGF0YS5zdGVtbWFwX3lhbWwsXG4gICAgcGFja190aXRsZTogZGF0YS5wYWNrX3RpdGxlLFxuICAgIGJwbTogZGF0YS5icG0sXG4gICAga2V5X3NpZ25hdHVyZTogZGF0YS5rZXlfc2lnbmF0dXJlLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gIH07XG4gIFxuICBhd2FpdCBjb2xsZWN0aW9uLnJlcGxhY2VPbmUoXG4gICAgeyB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkIH0sXG4gICAgZG9jLFxuICAgIHsgdXBzZXJ0OiB0cnVlIH1cbiAgKTtcbiAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3RlbW1hcCh1cGxvYWRJZCkge1xuICBjb25zdCBkYXRhYmFzZSA9IGF3YWl0IGdldERiKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCdzdGVtbWFwcycpO1xuICBjb25zdCBkb2MgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyB1cGxvYWRfaWQ6IHVwbG9hZElkIH0pO1xuICBpZiAoZG9jKSB7XG4gICAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUV4cG9ydChkYXRhKSB7XG4gIGNvbnN0IGRhdGFiYXNlID0gYXdhaXQgZ2V0RGIoKTtcbiAgY29uc3QgY29sbGVjdGlvbiA9IGRhdGFiYXNlLmNvbGxlY3Rpb24oJ2V4cG9ydHMnKTtcbiAgXG4gIGNvbnN0IGRvYyA9IHtcbiAgICBfaWQ6IGRhdGEuaWQsXG4gICAgdXBsb2FkX2lkOiBkYXRhLnVwbG9hZF9pZCxcbiAgICBleHBvcnRfdHlwZTogZGF0YS5leHBvcnRfdHlwZSxcbiAgICBvdXRwdXRfcGF0aDogZGF0YS5vdXRwdXRfcGF0aCxcbiAgICBtYW5pZmVzdF9qc29uOiBkYXRhLm1hbmlmZXN0X2pzb24sXG4gICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgfTtcbiAgXG4gIGF3YWl0IGNvbGxlY3Rpb24uaW5zZXJ0T25lKGRvYyk7XG4gIHJldHVybiB7IC4uLmRvYywgaWQ6IGRvYy5faWQgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cG9ydHModXBsb2FkSWQpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbignZXhwb3J0cycpO1xuICBjb25zdCBkb2NzID0gYXdhaXQgY29sbGVjdGlvblxuICAgIC5maW5kKHsgdXBsb2FkX2lkOiB1cGxvYWRJZCB9KVxuICAgIC5zb3J0KHsgY3JlYXRlZF9hdDogLTEgfSlcbiAgICAudG9BcnJheSgpO1xuICByZXR1cm4gZG9jcy5tYXAoZG9jID0+ICh7IC4uLmRvYywgaWQ6IGRvYy5faWQgfSkpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7IGdldERiIH07XG4iXSwibmFtZXMiOlsiTW9uZ29DbGllbnQiLCJNT05HT19VUkwiLCJwcm9jZXNzIiwiZW52IiwiREJfTkFNRSIsImNsaWVudCIsImRiIiwiZ2V0RGIiLCJjb25uZWN0IiwiY29sbGVjdGlvbiIsImNyZWF0ZUluZGV4IiwiY3JlYXRlZF9hdCIsInVwbG9hZF9pZCIsImNyZWF0ZVVwbG9hZCIsImRhdGEiLCJkYXRhYmFzZSIsImRvYyIsIl9pZCIsImlkIiwiZm9sZGVyX3BhdGgiLCJmb2xkZXJfbmFtZSIsImZpbGVfY291bnQiLCJ0b3RhbF9zaXplX2J5dGVzIiwic3RhdHVzIiwiRGF0ZSIsImluc2VydE9uZSIsImdldFVwbG9hZCIsImZpbmRPbmUiLCJnZXRBbGxVcGxvYWRzIiwiZG9jcyIsImZpbmQiLCJzb3J0IiwidG9BcnJheSIsIm1hcCIsInVwZGF0ZVVwbG9hZFN0YXR1cyIsInVwZGF0ZU9uZSIsIiRzZXQiLCJzYXZlQW5hbHlzaXNSZXN1bHQiLCJyYXdfaW5kZXhfanNvbiIsImFuYWx5c2lzX2luZGV4X2pzb24iLCJkdXBsaWNhdGVzX2pzb24iLCJyZXBsYWNlT25lIiwidXBzZXJ0IiwiZ2V0QW5hbHlzaXNSZXN1bHQiLCJ1cGxvYWRJZCIsInNhdmVTdGVtbWFwIiwic3RlbW1hcF95YW1sIiwicGFja190aXRsZSIsImJwbSIsImtleV9zaWduYXR1cmUiLCJnZXRTdGVtbWFwIiwic2F2ZUV4cG9ydCIsImV4cG9ydF90eXBlIiwib3V0cHV0X3BhdGgiLCJtYW5pZmVzdF9qc29uIiwiZ2V0RXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/db.js\n");

/***/ }),

/***/ "(api)/./src/pages/api/pipeline.js":
/*!***********************************!*\
  !*** ./src/pages/api/pipeline.js ***!
  \***********************************/
/***/ ((__webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var _lib_cli__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/cli */ \"(api)/./src/lib/cli.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/db */ \"(api)/./src/lib/db.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([uuid__WEBPACK_IMPORTED_MODULE_2__]);\nuuid__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const { uploadId, step } = req.body;\n        if (!uploadId) {\n            return res.status(400).json({\n                error: \"uploadId is required\"\n            });\n        }\n        const upload = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_4__.getUpload)(uploadId);\n        if (!upload) {\n            return res.status(404).json({\n                error: \"Upload not found\"\n            });\n        }\n        const packDir = upload.folder_path;\n        const analysisDir = path__WEBPACK_IMPORTED_MODULE_0__.join(packDir, \"analysis\");\n        await fs_promises__WEBPACK_IMPORTED_MODULE_1__.mkdir(analysisDir, {\n            recursive: true\n        });\n        const rawIndexPath = path__WEBPACK_IMPORTED_MODULE_0__.join(analysisDir, \"raw_index.json\");\n        const analysisIndexPath = path__WEBPACK_IMPORTED_MODULE_0__.join(analysisDir, \"analysis_index.json\");\n        if (step === \"scan\" || !step) {\n            // Step 1: Scan\n            await (0,_lib_db__WEBPACK_IMPORTED_MODULE_4__.updateUploadStatus)(uploadId, \"scanning\");\n            const stemsRawDir = path__WEBPACK_IMPORTED_MODULE_0__.join(packDir, \"stems_raw\");\n            await (0,_lib_cli__WEBPACK_IMPORTED_MODULE_3__.scan)(stemsRawDir, {\n                output: rawIndexPath,\n                verbose: true\n            });\n            // Read raw index\n            const rawIndex = JSON.parse(await fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile(rawIndexPath, \"utf-8\"));\n            await (0,_lib_db__WEBPACK_IMPORTED_MODULE_4__.updateUploadStatus)(uploadId, \"scanned\");\n            return res.status(200).json({\n                success: true,\n                step: \"scan\",\n                uploadId,\n                rawIndex,\n                duplicates: rawIndex.duplicates || [],\n                nextStep: \"analyze\"\n            });\n        }\n        if (step === \"analyze\") {\n            // Step 2: Analyze\n            await (0,_lib_db__WEBPACK_IMPORTED_MODULE_4__.updateUploadStatus)(uploadId, \"analyzing\");\n            await (0,_lib_cli__WEBPACK_IMPORTED_MODULE_3__.analyze)(rawIndexPath, {\n                output: analysisIndexPath,\n                parallel: 4,\n                verbose: true\n            });\n            // Read both indexes\n            const rawIndex = JSON.parse(await fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile(rawIndexPath, \"utf-8\"));\n            const analysisIndex = JSON.parse(await fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile(analysisIndexPath, \"utf-8\"));\n            // Save to database\n            await (0,_lib_db__WEBPACK_IMPORTED_MODULE_4__.saveAnalysisResult)({\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__.v4)(),\n                upload_id: uploadId,\n                raw_index_json: JSON.stringify(rawIndex),\n                analysis_index_json: JSON.stringify(analysisIndex),\n                duplicates_json: JSON.stringify(rawIndex.duplicates || [])\n            });\n            await (0,_lib_db__WEBPACK_IMPORTED_MODULE_4__.updateUploadStatus)(uploadId, \"analyzed\");\n            return res.status(200).json({\n                success: true,\n                step: \"analyze\",\n                uploadId,\n                analysisIndex,\n                fileCount: analysisIndex.files?.length || 0,\n                nextStep: \"export\"\n            });\n        }\n        return res.status(400).json({\n            error: \"Invalid step\"\n        });\n    } catch (error) {\n        console.error(\"Pipeline error:\", error);\n        return res.status(500).json({\n            error: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFlO0lBQ3RELEVBQUUsT0FBT0EsT0FBTztRQUNka0MsUUFBUWxDLEtBQUssQ0FBQyxtQkFBbUJBO1FBQ2pDLE9BQU9KLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBT0EsTUFBTW1DLE9BQU87UUFBQztJQUNyRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhyaXZlbi13ZWIvLi9zcmMvcGFnZXMvYXBpL3BpcGVsaW5lLmpzP2Y0Y2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQgeyBzY2FuLCBhbmFseXplIH0gZnJvbSAnQC9saWIvY2xpJztcbmltcG9ydCB7IGdldFVwbG9hZCwgdXBkYXRlVXBsb2FkU3RhdHVzLCBzYXZlQW5hbHlzaXNSZXN1bHQgfSBmcm9tICdAL2xpYi9kYic7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyB1cGxvYWRJZCwgc3RlcCB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIXVwbG9hZElkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ3VwbG9hZElkIGlzIHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB1cGxvYWQgPSBhd2FpdCBnZXRVcGxvYWQodXBsb2FkSWQpO1xuICAgIGlmICghdXBsb2FkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1VwbG9hZCBub3QgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHBhY2tEaXIgPSB1cGxvYWQuZm9sZGVyX3BhdGg7XG4gICAgY29uc3QgYW5hbHlzaXNEaXIgPSBwYXRoLmpvaW4ocGFja0RpciwgJ2FuYWx5c2lzJyk7XG4gICAgYXdhaXQgZnMubWtkaXIoYW5hbHlzaXNEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuXG4gICAgY29uc3QgcmF3SW5kZXhQYXRoID0gcGF0aC5qb2luKGFuYWx5c2lzRGlyLCAncmF3X2luZGV4Lmpzb24nKTtcbiAgICBjb25zdCBhbmFseXNpc0luZGV4UGF0aCA9IHBhdGguam9pbihhbmFseXNpc0RpciwgJ2FuYWx5c2lzX2luZGV4Lmpzb24nKTtcblxuICAgIGlmIChzdGVwID09PSAnc2NhbicgfHwgIXN0ZXApIHtcbiAgICAgIC8vIFN0ZXAgMTogU2NhblxuICAgICAgYXdhaXQgdXBkYXRlVXBsb2FkU3RhdHVzKHVwbG9hZElkLCAnc2Nhbm5pbmcnKTtcbiAgICAgIFxuICAgICAgY29uc3Qgc3RlbXNSYXdEaXIgPSBwYXRoLmpvaW4ocGFja0RpciwgJ3N0ZW1zX3JhdycpO1xuICAgICAgYXdhaXQgc2NhbihzdGVtc1Jhd0Rpciwge1xuICAgICAgICBvdXRwdXQ6IHJhd0luZGV4UGF0aCxcbiAgICAgICAgdmVyYm9zZTogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBSZWFkIHJhdyBpbmRleFxuICAgICAgY29uc3QgcmF3SW5kZXggPSBKU09OLnBhcnNlKGF3YWl0IGZzLnJlYWRGaWxlKHJhd0luZGV4UGF0aCwgJ3V0Zi04JykpO1xuXG4gICAgICBhd2FpdCB1cGRhdGVVcGxvYWRTdGF0dXModXBsb2FkSWQsICdzY2FubmVkJyk7XG5cbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHN0ZXA6ICdzY2FuJyxcbiAgICAgICAgdXBsb2FkSWQsXG4gICAgICAgIHJhd0luZGV4LFxuICAgICAgICBkdXBsaWNhdGVzOiByYXdJbmRleC5kdXBsaWNhdGVzIHx8IFtdLFxuICAgICAgICBuZXh0U3RlcDogJ2FuYWx5emUnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHN0ZXAgPT09ICdhbmFseXplJykge1xuICAgICAgLy8gU3RlcCAyOiBBbmFseXplXG4gICAgICBhd2FpdCB1cGRhdGVVcGxvYWRTdGF0dXModXBsb2FkSWQsICdhbmFseXppbmcnKTtcblxuICAgICAgYXdhaXQgYW5hbHl6ZShyYXdJbmRleFBhdGgsIHtcbiAgICAgICAgb3V0cHV0OiBhbmFseXNpc0luZGV4UGF0aCxcbiAgICAgICAgcGFyYWxsZWw6IDQsXG4gICAgICAgIHZlcmJvc2U6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgLy8gUmVhZCBib3RoIGluZGV4ZXNcbiAgICAgIGNvbnN0IHJhd0luZGV4ID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRmlsZShyYXdJbmRleFBhdGgsICd1dGYtOCcpKTtcbiAgICAgIGNvbnN0IGFuYWx5c2lzSW5kZXggPSBKU09OLnBhcnNlKGF3YWl0IGZzLnJlYWRGaWxlKGFuYWx5c2lzSW5kZXhQYXRoLCAndXRmLTgnKSk7XG5cbiAgICAgIC8vIFNhdmUgdG8gZGF0YWJhc2VcbiAgICAgIGF3YWl0IHNhdmVBbmFseXNpc1Jlc3VsdCh7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgdXBsb2FkX2lkOiB1cGxvYWRJZCxcbiAgICAgICAgcmF3X2luZGV4X2pzb246IEpTT04uc3RyaW5naWZ5KHJhd0luZGV4KSxcbiAgICAgICAgYW5hbHlzaXNfaW5kZXhfanNvbjogSlNPTi5zdHJpbmdpZnkoYW5hbHlzaXNJbmRleCksXG4gICAgICAgIGR1cGxpY2F0ZXNfanNvbjogSlNPTi5zdHJpbmdpZnkocmF3SW5kZXguZHVwbGljYXRlcyB8fCBbXSksXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgdXBkYXRlVXBsb2FkU3RhdHVzKHVwbG9hZElkLCAnYW5hbHl6ZWQnKTtcblxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgc3RlcDogJ2FuYWx5emUnLFxuICAgICAgICB1cGxvYWRJZCxcbiAgICAgICAgYW5hbHlzaXNJbmRleCxcbiAgICAgICAgZmlsZUNvdW50OiBhbmFseXNpc0luZGV4LmZpbGVzPy5sZW5ndGggfHwgMCxcbiAgICAgICAgbmV4dFN0ZXA6ICdleHBvcnQnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHN0ZXAnIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1BpcGVsaW5lIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInBhdGgiLCJmcyIsInY0IiwidXVpZHY0Iiwic2NhbiIsImFuYWx5emUiLCJnZXRVcGxvYWQiLCJ1cGRhdGVVcGxvYWRTdGF0dXMiLCJzYXZlQW5hbHlzaXNSZXN1bHQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwidXBsb2FkSWQiLCJzdGVwIiwiYm9keSIsInVwbG9hZCIsInBhY2tEaXIiLCJmb2xkZXJfcGF0aCIsImFuYWx5c2lzRGlyIiwiam9pbiIsIm1rZGlyIiwicmVjdXJzaXZlIiwicmF3SW5kZXhQYXRoIiwiYW5hbHlzaXNJbmRleFBhdGgiLCJzdGVtc1Jhd0RpciIsIm91dHB1dCIsInZlcmJvc2UiLCJyYXdJbmRleCIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlIiwic3VjY2VzcyIsImR1cGxpY2F0ZXMiLCJuZXh0U3RlcCIsInBhcmFsbGVsIiwiYW5hbHlzaXNJbmRleCIsImlkIiwidXBsb2FkX2lkIiwicmF3X2luZGV4X2pzb24iLCJzdHJpbmdpZnkiLCJhbmFseXNpc19pbmRleF9qc29uIiwiZHVwbGljYXRlc19qc29uIiwiZmlsZUNvdW50IiwiZmlsZXMiLCJsZW5ndGgiLCJjb25zb2xlIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/pipeline.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fpipeline&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fpipeline.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();
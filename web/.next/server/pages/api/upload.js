"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/upload";
exports.ids = ["pages/api/upload"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fupload.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fupload.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/upload.js */ \"(api)/./src/pages/api/upload.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/upload\",\n        pathname: \"/api/upload\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVwbG9hZCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGdXBsb2FkLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3NEO0FBQ3REO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhyaXZlbi13ZWIvP2VmMzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyYy9wYWdlcy9hcGkvdXBsb2FkLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdXBsb2FkXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXBsb2FkXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fupload.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/lib/db.js":
/*!***********************!*\
  !*** ./src/lib/db.js ***!
  \***********************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUpload: () => (/* binding */ createUpload),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getAllUploads: () => (/* binding */ getAllUploads),\n/* harmony export */   getAnalysisResult: () => (/* binding */ getAnalysisResult),\n/* harmony export */   getExports: () => (/* binding */ getExports),\n/* harmony export */   getStemmap: () => (/* binding */ getStemmap),\n/* harmony export */   getUpload: () => (/* binding */ getUpload),\n/* harmony export */   saveAnalysisResult: () => (/* binding */ saveAnalysisResult),\n/* harmony export */   saveExport: () => (/* binding */ saveExport),\n/* harmony export */   saveStemmap: () => (/* binding */ saveStemmap),\n/* harmony export */   updateUploadStatus: () => (/* binding */ updateUploadStatus)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n\nconst MONGO_URL = process.env.MONGO_URL || \"mongodb://localhost:27017\";\nconst DB_NAME = process.env.DB_NAME || \"thriven\";\nlet client = null;\nlet db = null;\nasync function getDb() {\n    if (db) return db;\n    client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(MONGO_URL);\n    await client.connect();\n    db = client.db(DB_NAME);\n    // Create indexes for better performance\n    await db.collection(\"uploads\").createIndex({\n        created_at: -1\n    });\n    await db.collection(\"analysis_results\").createIndex({\n        upload_id: 1\n    });\n    await db.collection(\"stemmaps\").createIndex({\n        upload_id: 1\n    });\n    await db.collection(\"exports\").createIndex({\n        upload_id: 1,\n        created_at: -1\n    });\n    return db;\n}\nasync function createUpload(data) {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    const doc = {\n        _id: data.id,\n        folder_path: data.folder_path,\n        folder_name: data.folder_name,\n        file_count: data.file_count || 0,\n        total_size_bytes: data.total_size_bytes || 0,\n        status: data.status || \"pending\",\n        created_at: new Date()\n    };\n    await collection.insertOne(doc);\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getUpload(id) {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    const doc = await collection.findOne({\n        _id: id\n    });\n    if (doc) {\n        return {\n            ...doc,\n            id: doc._id\n        };\n    }\n    return null;\n}\nasync function getAllUploads() {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    const docs = await collection.find({}).sort({\n        created_at: -1\n    }).toArray();\n    return docs.map((doc)=>({\n            ...doc,\n            id: doc._id\n        }));\n}\nasync function updateUploadStatus(id, status) {\n    const database = await getDb();\n    const collection = database.collection(\"uploads\");\n    await collection.updateOne({\n        _id: id\n    }, {\n        $set: {\n            status\n        }\n    });\n}\nasync function saveAnalysisResult(data) {\n    const database = await getDb();\n    const collection = database.collection(\"analysis_results\");\n    const doc = {\n        _id: data.id,\n        upload_id: data.upload_id,\n        raw_index_json: data.raw_index_json,\n        analysis_index_json: data.analysis_index_json,\n        duplicates_json: data.duplicates_json,\n        created_at: new Date()\n    };\n    await collection.replaceOne({\n        upload_id: data.upload_id\n    }, doc, {\n        upsert: true\n    });\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getAnalysisResult(uploadId) {\n    const database = await getDb();\n    const collection = database.collection(\"analysis_results\");\n    const doc = await collection.findOne({\n        upload_id: uploadId\n    });\n    if (doc) {\n        return {\n            ...doc,\n            id: doc._id\n        };\n    }\n    return null;\n}\nasync function saveStemmap(data) {\n    const database = await getDb();\n    const collection = database.collection(\"stemmaps\");\n    const doc = {\n        _id: data.id,\n        upload_id: data.upload_id,\n        stemmap_yaml: data.stemmap_yaml,\n        pack_title: data.pack_title,\n        bpm: data.bpm,\n        key_signature: data.key_signature,\n        created_at: new Date()\n    };\n    await collection.replaceOne({\n        upload_id: data.upload_id\n    }, doc, {\n        upsert: true\n    });\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getStemmap(uploadId) {\n    const database = await getDb();\n    const collection = database.collection(\"stemmaps\");\n    const doc = await collection.findOne({\n        upload_id: uploadId\n    });\n    if (doc) {\n        return {\n            ...doc,\n            id: doc._id\n        };\n    }\n    return null;\n}\nasync function saveExport(data) {\n    const database = await getDb();\n    const collection = database.collection(\"exports\");\n    const doc = {\n        _id: data.id,\n        upload_id: data.upload_id,\n        export_type: data.export_type,\n        output_path: data.output_path,\n        manifest_json: data.manifest_json,\n        created_at: new Date()\n    };\n    await collection.insertOne(doc);\n    return {\n        ...doc,\n        id: doc._id\n    };\n}\nasync function getExports(uploadId) {\n    const database = await getDb();\n    const collection = database.collection(\"exports\");\n    const docs = await collection.find({\n        upload_id: uploadId\n    }).sort({\n        created_at: -1\n    }).toArray();\n    return docs.map((doc)=>({\n            ...doc,\n            id: doc._id\n        }));\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    getDb\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cyI6WyJ3ZWJwYWNrOi8vdGhyaXZlbi13ZWIvLi9zcmMvbGliL2RiLmpzPzdmOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9uZ29DbGllbnQgfSBmcm9tICdtb25nb2RiJztcblxuY29uc3QgTU9OR09fVVJMID0gcHJvY2Vzcy5lbnYuTU9OR09fVVJMIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3JztcbmNvbnN0IERCX05BTUUgPSBwcm9jZXNzLmVudi5EQl9OQU1FIHx8ICd0aHJpdmVuJztcblxubGV0IGNsaWVudCA9IG51bGw7XG5sZXQgZGIgPSBudWxsO1xuXG5hc3luYyBmdW5jdGlvbiBnZXREYigpIHtcbiAgaWYgKGRiKSByZXR1cm4gZGI7XG4gIFxuICBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQoTU9OR09fVVJMKTtcbiAgYXdhaXQgY2xpZW50LmNvbm5lY3QoKTtcbiAgZGIgPSBjbGllbnQuZGIoREJfTkFNRSk7XG4gIFxuICAvLyBDcmVhdGUgaW5kZXhlcyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VwbG9hZHMnKS5jcmVhdGVJbmRleCh7IGNyZWF0ZWRfYXQ6IC0xIH0pO1xuICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdhbmFseXNpc19yZXN1bHRzJykuY3JlYXRlSW5kZXgoeyB1cGxvYWRfaWQ6IDEgfSk7XG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3N0ZW1tYXBzJykuY3JlYXRlSW5kZXgoeyB1cGxvYWRfaWQ6IDEgfSk7XG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ2V4cG9ydHMnKS5jcmVhdGVJbmRleCh7IHVwbG9hZF9pZDogMSwgY3JlYXRlZF9hdDogLTEgfSk7XG4gIFxuICByZXR1cm4gZGI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVcGxvYWQoZGF0YSkge1xuICBjb25zdCBkYXRhYmFzZSA9IGF3YWl0IGdldERiKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCd1cGxvYWRzJyk7XG4gIFxuICBjb25zdCBkb2MgPSB7XG4gICAgX2lkOiBkYXRhLmlkLFxuICAgIGZvbGRlcl9wYXRoOiBkYXRhLmZvbGRlcl9wYXRoLFxuICAgIGZvbGRlcl9uYW1lOiBkYXRhLmZvbGRlcl9uYW1lLFxuICAgIGZpbGVfY291bnQ6IGRhdGEuZmlsZV9jb3VudCB8fCAwLFxuICAgIHRvdGFsX3NpemVfYnl0ZXM6IGRhdGEudG90YWxfc2l6ZV9ieXRlcyB8fCAwLFxuICAgIHN0YXR1czogZGF0YS5zdGF0dXMgfHwgJ3BlbmRpbmcnLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gIH07XG4gIFxuICBhd2FpdCBjb2xsZWN0aW9uLmluc2VydE9uZShkb2MpO1xuICByZXR1cm4geyAuLi5kb2MsIGlkOiBkb2MuX2lkIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVcGxvYWQoaWQpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbigndXBsb2FkcycpO1xuICBjb25zdCBkb2MgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyBfaWQ6IGlkIH0pO1xuICBpZiAoZG9jKSB7XG4gICAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsVXBsb2FkcygpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbigndXBsb2FkcycpO1xuICBjb25zdCBkb2NzID0gYXdhaXQgY29sbGVjdGlvbi5maW5kKHt9KS5zb3J0KHsgY3JlYXRlZF9hdDogLTEgfSkudG9BcnJheSgpO1xuICByZXR1cm4gZG9jcy5tYXAoZG9jID0+ICh7IC4uLmRvYywgaWQ6IGRvYy5faWQgfSkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXBsb2FkU3RhdHVzKGlkLCBzdGF0dXMpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbigndXBsb2FkcycpO1xuICBhd2FpdCBjb2xsZWN0aW9uLnVwZGF0ZU9uZSh7IF9pZDogaWQgfSwgeyAkc2V0OiB7IHN0YXR1cyB9IH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUFuYWx5c2lzUmVzdWx0KGRhdGEpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbignYW5hbHlzaXNfcmVzdWx0cycpO1xuICBcbiAgY29uc3QgZG9jID0ge1xuICAgIF9pZDogZGF0YS5pZCxcbiAgICB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkLFxuICAgIHJhd19pbmRleF9qc29uOiBkYXRhLnJhd19pbmRleF9qc29uLFxuICAgIGFuYWx5c2lzX2luZGV4X2pzb246IGRhdGEuYW5hbHlzaXNfaW5kZXhfanNvbixcbiAgICBkdXBsaWNhdGVzX2pzb246IGRhdGEuZHVwbGljYXRlc19qc29uLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gIH07XG4gIFxuICBhd2FpdCBjb2xsZWN0aW9uLnJlcGxhY2VPbmUoXG4gICAgeyB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkIH0sXG4gICAgZG9jLFxuICAgIHsgdXBzZXJ0OiB0cnVlIH1cbiAgKTtcbiAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QW5hbHlzaXNSZXN1bHQodXBsb2FkSWQpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbignYW5hbHlzaXNfcmVzdWx0cycpO1xuICBjb25zdCBkb2MgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyB1cGxvYWRfaWQ6IHVwbG9hZElkIH0pO1xuICBpZiAoZG9jKSB7XG4gICAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZVN0ZW1tYXAoZGF0YSkge1xuICBjb25zdCBkYXRhYmFzZSA9IGF3YWl0IGdldERiKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCdzdGVtbWFwcycpO1xuICBcbiAgY29uc3QgZG9jID0ge1xuICAgIF9pZDogZGF0YS5pZCxcbiAgICB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkLFxuICAgIHN0ZW1tYXBfeWFtbDogZGF0YS5zdGVtbWFwX3lhbWwsXG4gICAgcGFja190aXRsZTogZGF0YS5wYWNrX3RpdGxlLFxuICAgIGJwbTogZGF0YS5icG0sXG4gICAga2V5X3NpZ25hdHVyZTogZGF0YS5rZXlfc2lnbmF0dXJlLFxuICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gIH07XG4gIFxuICBhd2FpdCBjb2xsZWN0aW9uLnJlcGxhY2VPbmUoXG4gICAgeyB1cGxvYWRfaWQ6IGRhdGEudXBsb2FkX2lkIH0sXG4gICAgZG9jLFxuICAgIHsgdXBzZXJ0OiB0cnVlIH1cbiAgKTtcbiAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3RlbW1hcCh1cGxvYWRJZCkge1xuICBjb25zdCBkYXRhYmFzZSA9IGF3YWl0IGdldERiKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCdzdGVtbWFwcycpO1xuICBjb25zdCBkb2MgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyB1cGxvYWRfaWQ6IHVwbG9hZElkIH0pO1xuICBpZiAoZG9jKSB7XG4gICAgcmV0dXJuIHsgLi4uZG9jLCBpZDogZG9jLl9pZCB9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUV4cG9ydChkYXRhKSB7XG4gIGNvbnN0IGRhdGFiYXNlID0gYXdhaXQgZ2V0RGIoKTtcbiAgY29uc3QgY29sbGVjdGlvbiA9IGRhdGFiYXNlLmNvbGxlY3Rpb24oJ2V4cG9ydHMnKTtcbiAgXG4gIGNvbnN0IGRvYyA9IHtcbiAgICBfaWQ6IGRhdGEuaWQsXG4gICAgdXBsb2FkX2lkOiBkYXRhLnVwbG9hZF9pZCxcbiAgICBleHBvcnRfdHlwZTogZGF0YS5leHBvcnRfdHlwZSxcbiAgICBvdXRwdXRfcGF0aDogZGF0YS5vdXRwdXRfcGF0aCxcbiAgICBtYW5pZmVzdF9qc29uOiBkYXRhLm1hbmlmZXN0X2pzb24sXG4gICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgfTtcbiAgXG4gIGF3YWl0IGNvbGxlY3Rpb24uaW5zZXJ0T25lKGRvYyk7XG4gIHJldHVybiB7IC4uLmRvYywgaWQ6IGRvYy5faWQgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cG9ydHModXBsb2FkSWQpIHtcbiAgY29uc3QgZGF0YWJhc2UgPSBhd2FpdCBnZXREYigpO1xuICBjb25zdCBjb2xsZWN0aW9uID0gZGF0YWJhc2UuY29sbGVjdGlvbignZXhwb3J0cycpO1xuICBjb25zdCBkb2NzID0gYXdhaXQgY29sbGVjdGlvblxuICAgIC5maW5kKHsgdXBsb2FkX2lkOiB1cGxvYWRJZCB9KVxuICAgIC5zb3J0KHsgY3JlYXRlZF9hdDogLTEgfSlcbiAgICAudG9BcnJheSgpO1xuICByZXR1cm4gZG9jcy5tYXAoZG9jID0+ICh7IC4uLmRvYywgaWQ6IGRvYy5faWQgfSkpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7IGdldERiIH07XG4iXSwibmFtZXMiOlsiTW9uZ29DbGllbnQiLCJNT05HT19VUkwiLCJwcm9jZXNzIiwiZW52IiwiREJfTkFNRSIsImNsaWVudCIsImRiIiwiZ2V0RGIiLCJjb25uZWN0IiwiY29sbGVjdGlvbiIsImNyZWF0ZUluZGV4IiwiY3JlYXRlZF9hdCIsInVwbG9hZF9pZCIsImNyZWF0ZVVwbG9hZCIsImRhdGEiLCJkYXRhYmFzZSIsImRvYyIsIl9pZCIsImlkIiwiZm9sZGVyX3BhdGgiLCJmb2xkZXJfbmFtZSIsImZpbGVfY291bnQiLCJ0b3RhbF9zaXplX2J5dGVzIiwic3RhdHVzIiwiRGF0ZSIsImluc2VydE9uZSIsImdldFVwbG9hZCIsImZpbmRPbmUiLCJnZXRBbGxVcGxvYWRzIiwiZG9jcyIsImZpbmQiLCJzb3J0IiwidG9BcnJheSIsIm1hcCIsInVwZGF0ZVVwbG9hZFN0YXR1cyIsInVwZGF0ZU9uZSIsIiRzZXQiLCJzYXZlQW5hbHlzaXNSZXN1bHQiLCJyYXdfaW5kZXhfanNvbiIsImFuYWx5c2lzX2luZGV4X2pzb24iLCJkdXBsaWNhdGVzX2pzb24iLCJyZXBsYWNlT25lIiwidXBzZXJ0IiwiZ2V0QW5hbHlzaXNSZXN1bHQiLCJ1cGxvYWRJZCIsInNhdmVTdGVtbWFwIiwic3RlbW1hcF95YW1sIiwicGFja190aXRsZSIsImJwbSIsImtleV9zaWduYXR1cmUiLCJnZXRTdGVtbWFwIiwic2F2ZUV4cG9ydCIsImV4cG9ydF90eXBlIiwib3V0cHV0X3BhdGgiLCJtYW5pZmVzdF9qc29uIiwiZ2V0RXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/db.js\n");

/***/ }),

/***/ "(api)/./src/pages/api/upload.js":
/*!*********************************!*\
  !*** ./src/pages/api/upload.js ***!
  \*********************************/
/***/ ((__webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/db */ \"(api)/./src/lib/db.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_0__, uuid__WEBPACK_IMPORTED_MODULE_4__]);\n([formidable__WEBPACK_IMPORTED_MODULE_0__, uuid__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n// Use temp directory for uploads (works in containers)\nconst UPLOAD_DIR = process.env.UPLOAD_DIR || path__WEBPACK_IMPORTED_MODULE_2__.join(os__WEBPACK_IMPORTED_MODULE_3__.tmpdir(), \"thriven-uploads\");\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        // Ensure upload directory exists\n        await fs_promises__WEBPACK_IMPORTED_MODULE_1__.mkdir(UPLOAD_DIR, {\n            recursive: true\n        });\n        const uploadId = (0,uuid__WEBPACK_IMPORTED_MODULE_4__.v4)();\n        const uploadPath = path__WEBPACK_IMPORTED_MODULE_2__.join(UPLOAD_DIR, uploadId, \"stems_raw\");\n        await fs_promises__WEBPACK_IMPORTED_MODULE_1__.mkdir(uploadPath, {\n            recursive: true\n        });\n        const form = (0,formidable__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            uploadDir: uploadPath,\n            keepExtensions: true,\n            maxFileSize: 100 * 1024 * 1024,\n            maxFiles: 100,\n            filename: (name, ext, part)=>{\n                // Preserve original filename\n                return part.originalFilename || `${name}${ext}`;\n            }\n        });\n        const [fields, files] = await form.parse(req);\n        // Get uploaded files\n        const uploadedFiles = Array.isArray(files.files) ? files.files : [\n            files.files\n        ].filter(Boolean);\n        let totalSize = 0;\n        const fileList = [];\n        for (const file of uploadedFiles){\n            if (file) {\n                totalSize += file.size;\n                fileList.push({\n                    name: file.originalFilename,\n                    size: file.size,\n                    path: file.filepath\n                });\n            }\n        }\n        // Get folder name from form data\n        const folderName = Array.isArray(fields.folderName) ? fields.folderName[0] : fields.folderName || \"Uploaded Pack\";\n        // Save to database (MongoDB)\n        await (0,_lib_db__WEBPACK_IMPORTED_MODULE_5__.createUpload)({\n            id: uploadId,\n            folder_path: path__WEBPACK_IMPORTED_MODULE_2__.join(UPLOAD_DIR, uploadId),\n            folder_name: folderName,\n            file_count: fileList.length,\n            total_size_bytes: totalSize,\n            status: \"uploaded\"\n        });\n        return res.status(200).json({\n            success: true,\n            uploadId,\n            folderName,\n            fileCount: fileList.length,\n            totalSize,\n            files: fileList.map((f)=>({\n                    name: f.name,\n                    size: f.size\n                }))\n        });\n    } catch (error) {\n        console.error(\"Upload error:\", error);\n        return res.status(500).json({\n            error: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cGFjazovL3Rocml2ZW4td2ViLy4vc3JjL3BhZ2VzL2FwaS91cGxvYWQuanM/NTMzNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZm9ybWlkYWJsZSBmcm9tICdmb3JtaWRhYmxlJztcbmltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBvcyBmcm9tICdvcyc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCB7IGNyZWF0ZVVwbG9hZCB9IGZyb20gJ0AvbGliL2RiJztcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgYXBpOiB7XG4gICAgYm9keVBhcnNlcjogZmFsc2UsXG4gIH0sXG59O1xuXG4vLyBVc2UgdGVtcCBkaXJlY3RvcnkgZm9yIHVwbG9hZHMgKHdvcmtzIGluIGNvbnRhaW5lcnMpXG5jb25zdCBVUExPQURfRElSID0gcHJvY2Vzcy5lbnYuVVBMT0FEX0RJUiB8fCBwYXRoLmpvaW4ob3MudG1wZGlyKCksICd0aHJpdmVuLXVwbG9hZHMnKTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBFbnN1cmUgdXBsb2FkIGRpcmVjdG9yeSBleGlzdHNcbiAgICBhd2FpdCBmcy5ta2RpcihVUExPQURfRElSLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcblxuICAgIGNvbnN0IHVwbG9hZElkID0gdXVpZHY0KCk7XG4gICAgY29uc3QgdXBsb2FkUGF0aCA9IHBhdGguam9pbihVUExPQURfRElSLCB1cGxvYWRJZCwgJ3N0ZW1zX3JhdycpO1xuICAgIGF3YWl0IGZzLm1rZGlyKHVwbG9hZFBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuXG4gICAgY29uc3QgZm9ybSA9IGZvcm1pZGFibGUoe1xuICAgICAgdXBsb2FkRGlyOiB1cGxvYWRQYXRoLFxuICAgICAga2VlcEV4dGVuc2lvbnM6IHRydWUsXG4gICAgICBtYXhGaWxlU2l6ZTogMTAwICogMTAyNCAqIDEwMjQsIC8vIDEwME1CIHBlciBmaWxlXG4gICAgICBtYXhGaWxlczogMTAwLFxuICAgICAgZmlsZW5hbWU6IChuYW1lLCBleHQsIHBhcnQpID0+IHtcbiAgICAgICAgLy8gUHJlc2VydmUgb3JpZ2luYWwgZmlsZW5hbWVcbiAgICAgICAgcmV0dXJuIHBhcnQub3JpZ2luYWxGaWxlbmFtZSB8fCBgJHtuYW1lfSR7ZXh0fWA7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgW2ZpZWxkcywgZmlsZXNdID0gYXdhaXQgZm9ybS5wYXJzZShyZXEpO1xuXG4gICAgLy8gR2V0IHVwbG9hZGVkIGZpbGVzXG4gICAgY29uc3QgdXBsb2FkZWRGaWxlcyA9IEFycmF5LmlzQXJyYXkoZmlsZXMuZmlsZXMpID8gZmlsZXMuZmlsZXMgOiBbZmlsZXMuZmlsZXNdLmZpbHRlcihCb29sZWFuKTtcbiAgICBcbiAgICBsZXQgdG90YWxTaXplID0gMDtcbiAgICBjb25zdCBmaWxlTGlzdCA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBmaWxlIG9mIHVwbG9hZGVkRmlsZXMpIHtcbiAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgIHRvdGFsU2l6ZSArPSBmaWxlLnNpemU7XG4gICAgICAgIGZpbGVMaXN0LnB1c2goe1xuICAgICAgICAgIG5hbWU6IGZpbGUub3JpZ2luYWxGaWxlbmFtZSxcbiAgICAgICAgICBzaXplOiBmaWxlLnNpemUsXG4gICAgICAgICAgcGF0aDogZmlsZS5maWxlcGF0aCxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gR2V0IGZvbGRlciBuYW1lIGZyb20gZm9ybSBkYXRhXG4gICAgY29uc3QgZm9sZGVyTmFtZSA9IEFycmF5LmlzQXJyYXkoZmllbGRzLmZvbGRlck5hbWUpID8gZmllbGRzLmZvbGRlck5hbWVbMF0gOiBmaWVsZHMuZm9sZGVyTmFtZSB8fCAnVXBsb2FkZWQgUGFjayc7XG5cbiAgICAvLyBTYXZlIHRvIGRhdGFiYXNlIChNb25nb0RCKVxuICAgIGF3YWl0IGNyZWF0ZVVwbG9hZCh7XG4gICAgICBpZDogdXBsb2FkSWQsXG4gICAgICBmb2xkZXJfcGF0aDogcGF0aC5qb2luKFVQTE9BRF9ESVIsIHVwbG9hZElkKSxcbiAgICAgIGZvbGRlcl9uYW1lOiBmb2xkZXJOYW1lLFxuICAgICAgZmlsZV9jb3VudDogZmlsZUxpc3QubGVuZ3RoLFxuICAgICAgdG90YWxfc2l6ZV9ieXRlczogdG90YWxTaXplLFxuICAgICAgc3RhdHVzOiAndXBsb2FkZWQnLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB1cGxvYWRJZCxcbiAgICAgIGZvbGRlck5hbWUsXG4gICAgICBmaWxlQ291bnQ6IGZpbGVMaXN0Lmxlbmd0aCxcbiAgICAgIHRvdGFsU2l6ZSxcbiAgICAgIGZpbGVzOiBmaWxlTGlzdC5tYXAoZiA9PiAoeyBuYW1lOiBmLm5hbWUsIHNpemU6IGYuc2l6ZSB9KSksXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignVXBsb2FkIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImZvcm1pZGFibGUiLCJmcyIsInBhdGgiLCJvcyIsInY0IiwidXVpZHY0IiwiY3JlYXRlVXBsb2FkIiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsIlVQTE9BRF9ESVIiLCJwcm9jZXNzIiwiZW52Iiwiam9pbiIsInRtcGRpciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJta2RpciIsInJlY3Vyc2l2ZSIsInVwbG9hZElkIiwidXBsb2FkUGF0aCIsImZvcm0iLCJ1cGxvYWREaXIiLCJrZWVwRXh0ZW5zaW9ucyIsIm1heEZpbGVTaXplIiwibWF4RmlsZXMiLCJmaWxlbmFtZSIsIm5hbWUiLCJleHQiLCJwYXJ0Iiwib3JpZ2luYWxGaWxlbmFtZSIsImZpZWxkcyIsImZpbGVzIiwicGFyc2UiLCJ1cGxvYWRlZEZpbGVzIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsdGVyIiwiQm9vbGVhbiIsInRvdGFsU2l6ZSIsImZpbGVMaXN0IiwiZmlsZSIsInNpemUiLCJwdXNoIiwiZmlsZXBhdGgiLCJmb2xkZXJOYW1lIiwiaWQiLCJmb2xkZXJfcGF0aCIsImZvbGRlcl9uYW1lIiwiZmlsZV9jb3VudCIsImxlbmd0aCIsInRvdGFsX3NpemVfYnl0ZXMiLCJzdWNjZXNzIiwiZmlsZUNvdW50IiwibWFwIiwiZiIsImNvbnNvbGUiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/upload.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fupload.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();